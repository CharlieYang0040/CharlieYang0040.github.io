## 7강: MaterialX LAMA와 XPU 렌더링 실습

### 수업 목표

- RenderMan의 첨단 레이어 기반 셰이딩 시스템, **MaterialX LAMA**의 작동 원리를 배웁니다.
- LAMA의 핵심 노드들을 활용하여, 기초 재질부터 여러 층으로 이루어진 복합 재질까지 제작하는 방법을 실습합니다.
- RenderMan의 하이브리드 렌더링 엔진 **XPU**의 개념과 강점을 명확히 이해하고, 실제 작업에서 어떻게 활성화하고 사용하는지 익힙니다.
- LAMA의 정교한 셰이딩과 XPU의 압도적인 속도를 결합한 최신 인터랙티브 Lookdev 워크플로우를 완성합니다.

---

### **1. XPU: 렌더링의 패러다임을 바꾸는 하이브리드 엔진**

LAMA를 배우기 전에, 이 모든 과정을 가능하게 할 강력한 엔진인 **XPU**부터 확실히 이해해야 합니다.

**XPU**는 RenderMan의 혁신적인 렌더링 엔진으로, 컴퓨터의 **CPU와 GPU를 동시에 사용**하여 렌더링 속도를 극적으로 끌어올립니다.

> 건축 현장 비유: 🏗️ 거대한 건물을 짓는다고 상상해 보세요.
> 
> - **CPU**는 섬세하고 복잡한 계산이 필요한 '특수 기술자' 팀과 같습니다. SSS, 볼륨, 복잡한 재질의 상호작용 등 까다로운 작업을 매우 정확하게 처리합니다.
> - **GPU**는 단순하고 반복적인 작업을 엄청난 속도로 해치우는 '대규모 건설 인부' 팀과 같습니다. 수백만 개의 광선 경로를 추적하는 핵심 연산을 수천 개의 코어로 동시에 처리합니다.
> 
> **XPU**는 이 두 팀을 동시에 지휘하는 '현장 감독'입니다. 각자의 장점에 맞는 작업을 실시간으로 분배하여, CPU와 GPU가 함께 100%의 성능으로 렌더링을 완성하게 만듭니다.
> 

### **XPU의 특징 및 강점**

- **압도적인 속도:** ⚡ 특히 Lookdev 및 라이팅 단계에서 아티스트가 거의 실시간에 가까운 속도로 최종 퀄리티의 결과물을 확인하며 작업할 수 있습니다.
- **인터랙티브 워크플로우:** 재질의 색상, 조명의 위치를 살짝 바꿨을 때, 몇 분을 기다릴 필요 없이 즉시 최종 결과물을 확인할 수 있어 창의적인 시도를 마음껏 할 수 있게 됩니다.
- **하드웨어 효율 극대화:** 컴퓨터에 장착된 모든 연산 자원(CPU, GPU)을 남김없이 사용하여 최고의 효율을 이끌어냅니다.

### **XPU 사용법**

XPU를 활성화하는 방법은 매우 간단합니다.

1. Maya 상단의 **Render Settings** 창을 엽니다.
2. 창 상단에 있는 **Render Using** 드롭다운 메뉴를 클릭합니다.
3. 기본값인 `RIS` 대신 **`XPU`*를 선택합니다.

이제부터 시작하는 모든 IPR(Interactive Preview Rendering) 렌더링은 XPU 엔진을 통해 실행됩니다. **오늘 모든 LAMA 실습은 반드시 XPU를 켠 상태로 진행합니다.**

---

### **2. MaterialX LAMA: 재질을 층층이 쌓아 올리는 연금술**

LAMA는 **LA**yered **MA**terial의 약자로, 고도로 전문화된 여러 개의 '재료' 노드들을 아티스트가 직접 층층이 쌓고 조합하여 재질을 창조하는 '모듈식 시스템'입니다.

> 요리 비유: 🍳 LAMA는 '최고급 밀가루', '유기농 토마토', '자연산 치즈' 등 각각의 완벽한 재료(LAMA 노드)를 셰프(아티스트)가 원하는 방식으로 층층이 쌓아 완전히 새로운 요리(재질)를 창조하는 과정과 같습니다.
> 

### **LAMA의 핵심 재료 (주요 노드)**

- `lama_conductor`: **금속** 재질을 위한 노드 (예: 크롬, 녹슨 철).
- `lama_dielectric`: **비금속** 재질을 위한 노드 (예: 플라스틱, 유리, 먼지, 페인트).
- `lama_layer`: **LAMA의 핵심.** 두 재질(Base, Top)을 마스크(Mix)를 이용해 섞어주는 컨트롤 타워입니다.

---

### **3. LAMA 재질 제작 실습 (기초부터 심화까지)**

이제 XPU 렌더링을 켠 상태에서 LAMA 재질을 단계별로 만들어 보겠습니다.

### **1단계: 기본적인 단일 재질 만들기**

- **금속 (Conductor):** **`lama_conductor`** 노드를 생성하고 물체에 적용한 뒤, `Roughness`와 `Edge Color`를 조절하며 XPU 뷰포트에서 실시간으로 변하는 재질을 확인합니다.
- **플라스틱 (Dielectric):** **`lama_dielectric`** 노드를 생성하고 `Color`와 `Roughness`를 조절하며 유광/무광 플라스틱의 느낌을 즉시 확인합니다.

### **2단계: '먼지 쌓인 유리' 만들기 (기본 레이어링)**

1. **유리층 (Base):** **`lama_dielectric`** 노드로 투명한 유리를 만듭니다. (`Transmission Gain` = 1)
2. **먼지층 (Top):** 또 다른 **`lama_dielectric`** 노드로 거친 먼지 재질을 만듭니다.
3. **마스크 (Mix):** `PxrFractal` (절차적 노이즈) → `PxrRemap` (대비 조절) 노드를 연결하여 먼지가 쌓일 영역을 결정하는 흑백 마스크를 생성합니다.
4. **조합:** **`lama_layer`** 노드에 각 층과 마스크를 연결합니다.
    - `Base Material` ← 유리
    - `Top Material` ← 먼지
    - `Mix` ← 마스크

XPU 뷰어에서 `PxrFractal`의 파라미터를 조절하면 먼지 패턴이 실시간으로 변하는 것을 보며 작업할 수 있습니다.

### **3. 심화: '칠이 벗겨지고 녹슨 금속' 만들기**

1. **녹슨 금속층 (아래):** `lama_conductor`로 만듭니다.
2. **페인트층 (위):** `lama_dielectric`으로 만듭니다.
3. **마스크:** `PxrFractal`로 페인트가 벗겨질 패턴을 만듭니다.
4. **조합:** `lama_layer`로 두 층을 섞어 줍니다. 이 모든 과정을 XPU의 즉각적인 피드백을 받으며 진행하면, 마치 디지털 조각을 하듯 매우 직관적으로 재질을 완성할 수 있습니다.

---

### **오늘의 실습 과제**

1. **XPU 설정:** Render Settings에서 렌더러를 **XPU**로 설정하고 IPR 렌더링을 시작합니다.
2. **기본 재질 생성:** `lama_conductor`와 `lama_dielectric` 노드를 각각 만들어보며 XPU의 인터랙티브 속도를 체감합니다.
3. **레이어 재질 제작:** 오늘 배운 워크플로우를 따라 **'먼지 쌓인 유리'** 또는 **'칠이 벗겨진 금속'** 재질을 직접 만들어 보세요.
4. **실시간 수정:** IPR 렌더링이 진행되는 동안, 마스크로 사용된 `PxrFractal` 노이즈의 `Frequency`, `Lacunarity` 등 다양한 파라미터를 수정하며 재질의 패턴이 실시간으로 어떻게 변하는지 관찰하고 원하는 결과물을 만들어 보세요.