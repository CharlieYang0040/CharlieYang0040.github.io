## 4강: AOV 개념 및 기본 활용

### 수업 목표

- *AOV(Arbitrary Output Variables)**의 개념을 이해하고, 렌더링 결과물을 여러 요소로 분리해야 하는 이유를 파악합니다.
- RenderMan for Maya에서 기본적인 AOV(Diffuse, Specular, Z-Depth 등)를 설정하고 출력하는 방법을 실습합니다.
- **Light Group**을 사용하여 특정 조명이 만들어내는 빛과 그림자만 따로 분리하여 렌더링하는 전문가 워크플로우를 익힙니다.
- *LPE(Light Path Expressions)**의 기본 개념을 이해하고, 원하는 빛의 경로만을 정밀하게 추출하는 방법을 맛봅니다.
- 그림자, 뎁스(Depth), 노멀(Normal) 등 후반 작업에 필수적인 데이터 패스(Data Pass)를 출력하고 그 활용법을 이해합니다.

---

### **1. AOV란 무엇인가? - 렌더링 결과물을 해부하다 🔬**

AOV는 **"임의 출력 변수"**라는 뜻으로, 최종적으로 보이는สวยงาม(beauty) 이미지 외에 렌더링 과정에서 계산되는 다양한 데이터들을 별도의 이미지(패스, Pass)로 출력하는 기능입니다.

> 요리 비유: 최종 렌더 이미지가 잘 만들어진 '피자'라면, AOV는 그 피자를 구성하는 '도우', '토마토소스', '치즈', '각종 토핑'을 각각 따로따로 접시에 담아내는 것과 같습니다. 후반 작업(합성) 단계에서 "치즈를 좀 더 노릇하게 만들고 싶은데?" 또는 "토마토소스를 조금만 더 추가하고 싶네?" 와 같은 요청이 있을 때, 피자 전체를 다시 굽는 대신 해당 재료만 살짝 조절하여 완벽한 결과물을 만들 수 있습니다.
> 

이처럼 AOV를 사용하면 렌더링을 다시 하지 않고도 각 요소의 색상, 밝기, 효과 등을 자유롭게 제어할 수 있어 작업의 유연성과 효율성을 극대화할 수 있습니다.

---

### **2. 기본 AOV 설정 및 출력하기**

RenderMan에서 AOV를 설정하는 것은 매우 직관적입니다.

1. **Render Settings** 창을 열고 **AOVs** 탭으로 이동합니다.
2. 왼쪽의 **Available AOVs** 리스트에서 원하는 AOV를 선택하여 오른쪽 화살표(`>`) 버튼을 눌러 **Active AOVs** 리스트로 옮깁니다.
3. 이제 렌더링을 하면 "It" 뷰어의 드롭다운 메뉴에서 활성화된 AOV들을 각각 확인할 수 있습니다.

**필수 실습 AOV:**

- **`diffuse`**: 재질의 고유 색상(Diffuse Lobe) 부분만 출력합니다.
- **`specular`**: 하이라이트와 반사(Specular Lobe) 부분만 출력합니다.
- **`z`**: 뎁스(Depth) 정보입니다. 카메라로부터의 거리를 흑백 이미지로 표현하며, 아웃포커싱(Depth of Field) 효과나 안개(Fog) 효과를 만들 때 사용됩니다.
- **`Nn`**: 노멀(Normal) 정보입니다. 표면의 방향을 RGB 값으로 저장하며, 렌더링 후에 조명의 방향을 바꾸는 '리라이팅(Relighting)' 작업에 사용됩니다.

---

### **3. 빛을 분리하다: Light Groups**

3강에서 Key, Fill, Rim Light를 설계했습니다. 만약 "Rim Light만 좀 더 강하게 만들고 싶다"면 어떻게 해야 할까요? 렌더링을 다시 하는 대신, 각 조명이 기여하는 결과물만 따로 뽑아내면 됩니다. 이것이 바로 **Light Group**의 역할입니다.

**실습 단계:**

1. **Light Group 이름 지정:**
    - Key Light를 선택하고 Attribute Editor의 `Light` 탭에서 **Advanced > Light Group** 파라미터에 `key` 라고 입력합니다.
    - 같은 방식으로 Fill Light에는 `fill`, Rim Light에는 `rim` 이라고 지정합니다. DomeLight에는 `env` 라고 지정해 줍시다.
2. **Light Group AOV 생성:**
    - AOV 설정 창 하단의 **LPE Tool** 섹션에서 `Create > Light Group`을 클릭합니다.
    - `Group Name`에 방금 지정한 `key`를 입력하고 `Create AOV`를 누릅니다. 그러면 `lgt_key`라는 AOV가 생성됩니다.
    - 이 과정을 `fill`, `rim`, `env`에 대해서도 반복합니다.
3. **결과 확인:**
    - 이제 렌더링을 하면 `lgt_key` AOV에는 Key Light가 만든 diffuse와 specular 결과만, `lgt_rim` AOV에는 Rim Light가 만든 결과만 독립적으로 담겨 출력됩니다. 합성 툴에서 이 패스들을 각각 불러와 강도를 조절하면 렌더링 없이 라이팅 밸런스를 맞출 수 있습니다.

---

### **4. 빛의 경로를 코딩하다: LPE (Light Path Expressions)**

LPE는 AOV를 훨씬 더 정밀하고 유연하게 제어하는 고급 기능입니다. 특정 종류의 빛이 특정 종류의 표면과 상호작용하는 경로를 '표현식(Expression)'으로 정의하여 추출합니다.

> 예를 들어, "Key Light(lgt_key)가 만들어낸 반사(specular) 성분만 정확히 보고 싶다" 와 같은 매우 구체적인 요구사항을 처리할 수 있습니다.
> 

기본 문법 맛보기:

LPE는 camera (표면 종류) (빛 종류) light 와 같은 구조를 가집니다.

- `ca<RD'diffuse'>[<L.'lgt_key'>]` → Key Light 그룹(`lgt_key`)이 만든 Diffuse(`diffuse`) 성분만 뽑아냅니다.

처음에는 복잡해 보이지만, AOV 설정 창의 **LPE Tool**을 사용하면 마우스 클릭만으로 원하는 LPE AOV를 쉽게 생성할 수 있습니다. 오늘은 LPE가 "AOV보다 훨씬 더 정밀한 제어가 가능한 기술"이라는 개념만 이해하고 넘어가겠습니다.

### **5. 그림자와 데이터 패스 활용**

- **그림자 패스(Shadow Pass):**
    - 그림자만 따로 렌더링하여 합성 시 실사 배경 위에 자연스럽게 올리거나 그림자의 농도, 색상을 조절하는 데 사용됩니다.
    - AOV 설정 창에서 **Create > Shadow**를 선택하고, 그림자를 만들 조명(예: Key Light)을 지정하여 생성할 수 있습니다. (`shadow_key_0` 과 같은 이름으로 생성됨)
- **데이터 패스(Data Pass):**
    - `z` (Depth), `Nn` (Normal), `P` (World Position) 등은 색상 정보가 아닌, 각 픽셀이 가진 위치나 방향 같은 **데이터**를 담고 있는 AOV입니다.
    - 이 패스들은 후반 작업에서 2D 효과(안개, 아웃포커싱)를 3D 공간에 자연스럽게 적용하거나, 3D 오브젝트를 추가로 합성할 때 정확한 위치를 찾는 등 매우 중요한 역할을 합니다.

### **오늘의 실습 과제**

1. 3강에서 작업했던 **3점 조명 씬**을 준비합니다.
2. **기본 AOV 출력:** `diffuse`, `specular`, `z`, `Nn` AOV를 활성화하여 렌더링하고, "It" 뷰어에서 각 패스가 어떻게 보이는지 확인하세요.
3. **Light Group 설정:**
    - Key, Fill, Rim, DomeLight에 각각 `key`, `fill`, `rim`, `env` 라는 Light Group을 지정합니다.
    - 각 Light Group에 대한 AOV(`lgt_key`, `lgt_fill` 등)를 생성하여 렌더링하고, 각 조명의 기여도가 정확히 분리되는지 확인하세요.
4. **그림자 패스 출력:** Key Light가 만드는 그림자만 별도로 출력하는 Shadow AOV를 생성하고 결과를 확인하세요.
5. **(도전 과제) LPE 생성:** LPE Tool을 사용하여 `rim` 라이트가 만들어내는 `specular` 성분만 뽑아내는 커스텀 AOV를 만들어 보세요.